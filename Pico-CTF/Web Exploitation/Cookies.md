# Cookies


**Points:** 40 

**Description:** Who doesn't love cookies? Try to figure out the best one. 




## Solution 


#### Initial Analysis

The link provided takes us to a simple web page that contains a form.

![Screenshot from 2023-07-04 12-44-32](https://github.com/HelsNetwork/CTF-writeups/assets/87879515/eb06831b-ceca-4901-a48e-242003256bb9)


The first thing I did is submitting the suggested word and other words while inspecting the cookies using the developer tools.

When submitting the suggested word I was redirected to 'http://mercury.pico.net<port>/check'

The cookie is set to: 

`name: "0"`

![Screenshot from 2023-07-04 12-48-32](https://github.com/HelsNetwork/CTF-writeups/assets/87879515/480e59d6-8f27-44b5-a9d3-3a0562e5561f)



And when submitting other words besides the suggested word (ie, Pico) an alert appeared. 

The cookie is set to:

`name:-"1"`

![Screenshot from 2023-07-04 12-55-09](https://github.com/HelsNetwork/CTF-writeups/assets/87879515/896466d4-2218-4438-bf4c-0ead46cec177)

With this information, I decided the change the value of `name` to 1. 



### Step 1: Change the value of name

In the developer tools, navigate to storage then cookies there change the value of name to 1 then refresh the page. 
![Screenshot from 2023-07-04 13-17-52](https://github.com/HelsNetwork/CTF-writeups/assets/87879515/1f25c22b-3d29-4865-b6d0-028e3a5ed49a)

There's a change that indicates that the correct `name` value needs to be determined in order to find the flag. Instead of doing it manually or using burp intruder, I decided to use a Python script.

### Step 2: Finding the right value using Python

Here's the script I used:

```python
import requests

for i in range(25):
    cookies = 'name={}'.format(i)
    header = {'Cookie':cookies}

    url = "http://mercury.picoctf.net:<port>/check"

    if response.status_ccode == 200 and 'picoCTF{' in response.text:
       print(response.text)
       break
```
Change the <port> with your port.

### Flag 

`` picoCTF{3v3ry1_l0v3s_c00k135_064663be}``
